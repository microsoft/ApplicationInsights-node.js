{"version":3,"file":"AuthorizationHandler.js","sourceRoot":"","sources":["../../Library/AuthorizationHandler.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,qDAAwD;AAExD,IAAM,2BAA2B,GAAG,qCAAqC,CAAC;AAG1E,SAAS,gBAAgB,CAAC,QAAmC;IAC3D,OAAO,IAAI,CAAC;AACd,CAAC;AAED;IAIE,8BAAY,UAAyC;QACnD,IAAI,MAAM,GAAa,CAAC,2BAA2B,CAAC,CAAC;QACrD,IAAI,CAAC,iBAAiB,GAAG,SAAS,CAAC,+BAA+B,CAAC,EAAE,UAAU,YAAA,EAAE,MAAM,QAAA,EAAE,CAAC,CAAC;IAC7F,CAAC;IAED;;MAEE;IACW,qDAAsB,GAAnC,UAAoC,cAA0D;;;;;;wBACxF,cAAc,GAAG,eAAe,CAAC;wBACjC,WAAW,GAAG,SAAS,CAAC,qBAAqB,CAAC,EAAE,GAAG,EAAE,UAAU,EAAE,CAAC,CAAC;wBACvE,qBAAM,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,WAAW,EAAE,gBAAgB,CAAC,EAAA;;wBAAvE,SAAuE,CAAC;wBACxE,cAAc,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;;;;;KAClF;IACH,2BAAC;AAAD,CAAC,AAlBD,IAkBC;AAED,iBAAS,oBAAoB,CAAC","sourcesContent":["import http = require(\"http\");\nimport https = require(\"https\");\nimport azureCoreAuth = require(\"@azure/core-auth\");\nimport azureCore = require(\"@azure/core-rest-pipeline\");\n\nconst applicationInsightsResource = \"https://monitor.azure.com//.default\";\n\n\nfunction emptySendRequest(_request: azureCore.PipelineRequest): Promise<azureCore.PipelineResponse> {\n  return null;\n}\n\nclass AuthorizationHandler {\n\n  private _azureTokenPolicy: azureCore.PipelinePolicy;\n\n  constructor(credential: azureCoreAuth.TokenCredential) {\n    let scopes: string[] = [applicationInsightsResource];\n    this._azureTokenPolicy = azureCore.bearerTokenAuthenticationPolicy({ credential, scopes });\n  }\n\n  /**\n  * Applies the Bearer token to the request through the Authorization header.\n  */\n  public async addAuthorizationHeader(requestOptions: http.RequestOptions | https.RequestOptions): Promise<void> {\n    let authHeaderName = \"authorization\";\n    let webResource = azureCore.createPipelineRequest({ url: \"https://\" });\n    await this._azureTokenPolicy.sendRequest(webResource, emptySendRequest);\n    requestOptions.headers[authHeaderName] = webResource.headers.get(authHeaderName);\n  }\n}\n\nexport = AuthorizationHandler;\n"]}